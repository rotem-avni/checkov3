metadata:
  id: CKV3_SAST_40
  name: Ensure that HTTP connection is secure (HTTPS)
  category: sast
  cwe: "CWE-319: Cleartext Transmission of Sensitive Information"
scope:
  languages:
    - javascript
definition:
  - or:
    - cond_type: "pattern"
      operator: "equals"
      value: |
        $AXIOS = require('axios');
        ...
        $AXIOS($OPTIONS,...);
    - cond_type: "pattern"
      operator: "equals"
      value: |
        import axios from 'axios';
        ...
        axios($OPTIONS,...);
    - cond_type: "pattern"
      operator: "equals"
      value: |
        $AXIOS = require('axios');
        ...
        $PARAM = $OPTIONS
        ...
        axios($PARAM,...);
    - cond_type: "pattern"
      operator: "equals"
      value: |
        import axios from 'axios';
        ...
        $PARAM = $OPTIONS
        ...
        axios($PARAM,...);
  - cond_type: variable
    variable: $OPTIONS
    operator: pattern_match
    value:
      - or:
        - cond_type: pattern
          operator: equals
          value: >
            {baseURL: $HTTP_URL}
        - cond_type: pattern
          operator: equals
          value: >
            {url: $HTTP_URL}
      - cond_type: pattern
        variable: $HTTP_URL
        operator: regex_match
        value: (http:)
