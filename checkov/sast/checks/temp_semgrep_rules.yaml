rules:
- id: CKV3_SAST_10_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_pattern_variable_rendering.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable pattern
  patterns:
  - pattern: os.system($ARG)
  - metavariable-pattern:
      metavariable: $ARG
      pattern: os.getcwd()
  severity: WARNING
- id: CKV3_SAST_14_python
  languages:
  - python
  message: E2E-Test multiline pattern
  metadata:
    check_file: simple_multiline_pattern.yaml
    cwe: CWE-2
    name: E2E-Test multiline pattern
  patterns:
  - pattern: 'a = 0

      b = 0

      a = 0'
  severity: WARNING
- id: CKV3_SAST_9_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_pattern.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable pattern
  patterns:
  - pattern: os.system($ARG)
  - metavariable-pattern:
      metavariable: $ARG
      pattern: os.getcwd()
  severity: WARNING
- id: CKV3_SAST_15_python
  languages:
  - python
  message: E2E regex pattern
  metadata:
    check_file: simple_regex_pattern.yaml
    cwe: E2E regex pattern
    name: E2E regex pattern
  pattern-regex: (os.exec|subprocess.run)
  severity: WARNING
- id: CKV3_SAST_12_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_regex_not_match.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable int not equal
  severity: WARNING
- id: CKV3_SAST_6_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_int_equal.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable int equal
  patterns:
  - pattern: equal($ARG)
  - metavariable-comparison:
      comparison: $ARG == 20
      metavariable: $ARG
  severity: WARNING
- id: CKV3_SAST_11_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_regex_match.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable int not equal
  patterns:
  - pattern: os.system($ARG)
  - metavariable-regex:
      metavariable: $ARG
      regex: (sudo|gsudo)
  severity: WARNING
- id: CKV3_SAST_5_python
  languages:
  - python
  message: E2E-Test multiline pattern
  metadata:
    check_file: multiline_pattern_2.yaml
    cwe: CWE-111
    name: requests should not use HTTP over port 80
  patterns:
  - pattern: 'port = 80

      protocol = ''http''

      resp = requests.get(f''{protocol}://myapi/data:{port}'')'
  severity: WARNING
- id: CKV3_SAST_13_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_variable_rendering.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable int equal
  patterns:
  - pattern: danger($ARG)
  - metavariable-comparison:
      comparison: $ARG >= 20
      metavariable: $ARG
  severity: WARNING
- id: CKV3_SAST_8_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_int_not_equal.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable int not equal
  patterns:
  - pattern: equal($ARG)
  - metavariable-comparison:
      comparison: $ARG != 20
      metavariable: $ARG
  severity: WARNING
- id: CKV3_SAST_7_python
  languages:
  - python
  message: E2E-Test simple pattern
  metadata:
    check_file: simple_metavariable_int_less_than.yaml
    cwe: CWE-1
    name: E2E-Test simple metavariable int less than
  patterns:
  - pattern: equal($ARG)
  - metavariable-comparison:
      comparison: $ARG < 20
      metavariable: $ARG
  severity: WARNING
- id: CKV3_SAST_3_python
  languages:
  - python
  message: Use of assert detected. The enclosed code will be removed when compiling
    to optimized byte code.
  metadata:
    check_file: simple_not_within.yaml
    cwe: 'CWE-754: Improper Check for Unusual or Exceptional Conditions'
    name: Ensure checking for unusual or exceptional conditions is handled properly
  patterns:
  - pattern: set_port(1)
  - pattern-not-inside: safe(set_port(1))
  - pattern-not-inside: super_safe(set_port(1))
  severity: WARNING
- id: CKV3_SAST_4_python
  languages:
  - python
  message: Use of assert detected. The enclosed code will be removed when compiling
    to optimized byte code.
  metadata:
    check_file: simple_within.yaml
    cwe: 'CWE-754: Improper Check for Unusual or Exceptional Conditions'
    name: Ensure checking for unusual or exceptional conditions is handled properly
  patterns:
  - pattern: set_port(1)
  - pattern-inside: danger(set_port(1))
  severity: WARNING
- id: CKV3_SAST_2_python
  languages:
  - python
  message: Detected use of the wildcard character in a system call that spawns a shell.
    This subjects the wildcard to normal shell expansion, which can have unintended
    consequences if there exist any non-standard file names. Consider a file named
    '-e sh script.sh' -- this will execute a script when 'rsync' is called. See https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.tx
    for more information.
  metadata:
    check_file: WildCardNeutralization.yaml
    cwe: 'CWE-155: Improper Neutralization of Wildcards or Matching Symbols'
    name: Ensure the neutralization of wildcards or matching symbols is handled properly
    owasp: 'A1: Injection'
  pattern-either:
  - pattern: os.system("tar -czf archive.tar.gz *")
  - pattern: os.popen("tar -czf archive.tar.gz *")
  - pattern: os.popen2("tar -czf archive.tar.gz *")
  - pattern: os.popen3("tar -czf archive.tar.gz *")
  - pattern: os.popen4("tar -czf archive.tar.gz *")
  severity: WARNING
- id: CKV3_SAST_1_python
  languages:
  - python
  message: The use of "exec" is risky.
  metadata:
    check_file: AvoidExec.yaml
    cwe: 'CWE-78: Improper Neutralization of Special Elements used in an OS Command
      ("OS Command Injection")'
    name: Ensure 'exec' is not used
    owasp: 'A1: Injection'
  pattern: exec(program)
  severity: WARNING
