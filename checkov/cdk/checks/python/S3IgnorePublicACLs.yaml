metadata:
  version: 0.2
  id: CKV_AWS_55
  name: Ensure S3 bucket has ignore public ACLs enabled
  category: GENERAL_SECURITY
scope:
  languages:
    - python
definition:
  or:
    - pattern: $ARG = $S3.Bucket(<ANY>)
      conditions:
        - not_pattern: |
            $ARG = $S3.Bucket(<ANY>,
                        block_public_access=$S3.BlockPublicAccess(
                          ignore_public_acls=True
                        ),<ANY>)
        - within: |
            from aws_cdk import aws_s3 as $S3
            <ANY>
    - pattern: $ARG = aws_s3.Bucket(<ANY>)
      conditions:
        - not_pattern: |
            $ARG = aws_s3.Bucket(<ANY>,
                            block_public_access=aws_s3.BlockPublicAccess(
                              ignore_public_acls=True
                            ),<ANY>)
        - within: |
            from aws_cdk import aws_s3
            <ANY>
